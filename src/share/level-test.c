#undef NDEBUG
#include <assert.h>
#include "level.h"

#define nelems(a) ((int) (sizeof (a) / sizeof ((a)[0])))

static char *level =
	"1.000000 1.000000 -1.000000 "
	"1.000000 -1.000000 -1.000000 "
	"-1.000000 -1.000000 -1.000000 \n"

	"-1.000000 -1.000000 -1.000000 "
	"-1.000000 1.000000 -1.000000 "
	"1.000000 1.000000 -1.000000 \n"

	"1.000000 0.999999 1.000000 "
	"-1.000000 1.000000 1.000000 "
	"-1.000000 -1.000000 1.000000 \n"

	"-1.000000 -1.000000 1.000000 "
	"0.999999 -1.000001 1.000000 "
	"1.000000 0.999999 1.000000 \n";

static float expected[] = {
	1.0, 1.0, -1.0,
	1.0, -1.0, -1.0,
	-1.0, -1.0, -1.0,

	-1.0, -1.0, -1.0,
	-1.0, 1.0, -1.0,
	1.0, 1.0, -1.0,

	1.0, 0.999999, 1.0,
	-1.0, 1.0, 1.0,
	-1.0, -1.0, 1.0,

	-1.0, -1.0, 1.0,
	0.999999, -1.000001, 1.0,
	1.0, 0.999999, 1.0
};

int main(void)
{
	static float test[nelems(expected) + 1];
	int i;

	assert(level_parse(level, test) == nelems (expected));
	for (i = 0; i < nelems (expected); i++)
		assert(test[i] == expected[i]);
	return 0;
}
